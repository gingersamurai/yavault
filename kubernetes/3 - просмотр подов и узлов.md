## Цели
- узнать о подах
- узнать об узлах
- научиться устранять неполадки в развернутых приложениях

## Под
Когда вы создали развертывание в [2 - развертывание приложения](2%20-%20развертывание%20приложения.md), Kubernetes создал под для размещения экземпляра вашего приложения.
Под - это абстракция Kubernetes, которая представляет собой группу из одного или нескольких контейнеров приложений (например, Docker) и некоторые общие ресурсы для этих контейнеров. 
К таким ресурсам относятся:
- общее хранилище, в виде томов
- сетевые ресурсы в виде уникального IP-адреса кластера
- Информация о том, как запустить каждый контейнер, например, версия образа контейнера или конкретные порты для использования

Под моделирует специфический для приложения "логический узел" и может содержать различные контейнеры приложений, которые относительно тесно связаны между собой. Например, Pod может включать как контейнер с вашим приложением Node.js, так и другой контейнер, который передает данные для публикации веб-сервером Node.js. Контейнеры в Pod разделяют IP-адрес и пространство портов, всегда находятся в одном месте и расписании, и выполняются в общем контексте на одном и том же узле.

Поды - это атомарная единица на платформе Kubernetes. Когда мы создаем развертывание на Kubernetes, это развертывание создает поды с контейнерами внутри них (в отличие от создания контейнеров напрямую). Каждый под привязан к узлу, на котором он шедулится, и остается там до завершения (в соответствии с политикой перезапуска) или удаления. В случае сбоя узла идентичные поды шедулятся на других доступных узлах кластера.

### Обзор подов
![](Pasted%20image%2020230614211946.png)
Под всегда запускается на узле. Узел - это рабочая машина в Kubernetes, которая может быть виртуальной или физической машиной, в зависимости от кластера. Каждый узел управляется плоскостью управления. Узел может иметь несколько подов, и плоскость управления Kubernetes автоматически управляет планированием подов на всех узлах кластера. При автоматическом планировании плоскость управления учитывает доступные ресурсы на каждом узле.

На каждом узле Kubernetes работает как минимум:
- Kubelet, процесс, отвечающий за связь между плоскостью управления Kubernetes и узлом; он управляет подами и контейнерами, запущенными на машине.
- рантайм контейнера (например, Docker), отвечающий за извлечение образа контейнера из реестра, распаковку контейнера и запуск приложения.
## Обзор ноды
![](Pasted%20image%2020230614213252.png)
## Устранение неполадок с помощью kubectl
Наиболее распространенные операции можно выполнить с помощью следующих подкоманд kubectl:
- `kubectl get` - вывести список ресурсов
- `kubectl describe` - показать подробную информацию о ресурсе
- `kubectl logs` - распечатать журналы из контейнера в поде
- `kubectl exec` - выполнить команду на контейнере в поде

## Посмотреть конфигурацию приложения

Давайте проверим, что приложение, которое мы развернули в предыдущем сценарии, запущено. Воспользуемся командой `kubectl get` и поищем существующие поды:
```bash
kobectl get pods
```

Далее, чтобы посмотреть, какие контейнеры находятся внутри этого пода и какие образы используются для создания этих контейнеров, мы выполняем команду `kubectl describe pods`:

```bash
kubectl describe pods
```

```
Name:             kubernetes-bootcamp-5485cc6795-qkczl
Namespace:        default
Priority:         0
Service Account:  default
Node:             minikube/192.168.49.2
Start Time:       Wed, 14 Jun 2023 20:38:26 +0300
Labels:           app=kubernetes-bootcamp
                  pod-template-hash=5485cc6795
Annotations:      <none>
Status:           Running
IP:               10.244.0.7
IPs:
  IP:           10.244.0.7
Controlled By:  ReplicaSet/kubernetes-bootcamp-5485cc6795
Containers:
  kubernetes-bootcamp:
    Container ID:   docker://c0509cdfd6f5c81ab71a8a25830e31394a5fd24134ce0fa60c33d525a4572551
    Image:          gcr.io/google-samples/kubernetes-bootcamp:v1
    Image ID:       docker-pullable://gcr.io/google-samples/kubernetes-bootcamp@sha256:0d6b8ee63bb57c5f5b6156f446b3bc3b3c143d233037f3a2f00e279c8fcc64af
    Port:           <none>
    Host Port:      <none>
    State:          Running
      Started:      Wed, 14 Jun 2023 20:38:44 +0300
    Ready:          True
    Restart Count:  0
    Environment:    <none>
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-tlw4s (ro)
Conditions:
  Type              Status
  Initialized       True 
  Ready             True 
  ContainersReady   True 
  PodScheduled      True 
Volumes:
  kube-api-access-tlw4s:
    Type:                    Projected (a volume that contains injected data from multiple sources)
    TokenExpirationSeconds:  3607
    ConfigMapName:           kube-root-ca.crt
    ConfigMapOptional:       <nil>
    DownwardAPI:             true
QoS Class:                   BestEffort
Node-Selectors:              <none>
Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists for 300s
                             node.kubernetes.io/unreachable:NoExecute op=Exists for 300s
Events:                      <none>
```
Здесь мы видим подробную информацию о контейнере Pod: IP-адрес, используемые порты и список событий, связанных с жизненным циклом Pod.

> **Примечание**: подкоманда describe может использоваться для получения подробной информации о большинстве примитивов Kubernetes, включая узлы, поды и развертывания. Вывод describe предназначен для чтения человеком, а не для написания сценариев.

