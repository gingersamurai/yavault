---
title: 'лекция 4-2: проектирование программ и распределенных систем'
updated: 2023-04-17 08:32:52Z
created: 2023-04-14 09:05:59Z
latitude: 55.43124530
longitude: 37.54576470
altitude: 0.0000
tags:
  - паттерны проектирования
---

# План занятия

1.  SOLID, DRY, KISS, YAGNI
2.  Архитектурные паттерны
3.  Обзор паттернов проектирования программ
4.  Проектирование распределенных систем

[стать на хабре про solid в Go](https://habr.com/ru/articles/348852/)

# 1\. SOLID, DRY, KISS, YAGNI

## SOLID

|     |     |     |
| --- | --- | --- |
| **Инициал** | **Представляет** | **Название понятие** |
| S   | SRP | *прицип единственной отвественности (single responsibility principle)*<br>Для каждого класса должно быть определено единственное нащначение. Все ресурсы, необходимы для его осуществления, должны быть инкапсулированы в этот класс и подчинены только этой задаче |
| O   | OCP | *Принцип открытости/закрытости (open/closed principle)*<br>программные сущности ... должны быть открыты для расширения, но закрыты для модификации |
| L   | LSP | *Принцип подстановки Лисков (Liskov substitution principle)*<br>Обьекты должны быть заменяемыми на экземпляры их подтиов без изменения правильности выполнения программы |
| I   | ISP | Принцип разделения интерфейса (interface segregation principle)<br>Много интерфейсов, специально предназначенных для клиентов, лучше, чем один интерфейс общего назначения |
| D   | DIP | Принцип инверсии зависимостей (dependency inversion principle)<br>Зависимость на Абстракциях. Нет зависимости на что-то конкретное |

### Принцип единственной ответственности

**Идея: **Каждый обьект должен иметь одну ответственность и эта ответственность должна быть полностью инкапсулирована в класс. Все его поведения  должны быть направлены исключитеSOLID, DRY, KISS, YAGNI  льно на обеспечение этой отSOLID, DRY, KISS, YAGNIветственности.

> A class should have only one reson to change.
> 
> (Robert C. Martin)

1.  В Go один пакет - одна зона ответственности
2.  Если пакет имеет название, которое не говорит о его сути \- скорее всего это плохой пакет
3.  Хорошие имена пакетов
    - net/http, который представляет http клиент и сервер.
    - os/exec, который запускает внешние команды.
    - encoding/json, который реализует кодирование и декодирование документов JSON

### Принцип открытости/закрытости (open-closed principle)

> программные обьекты должны быть открыты для расширения и закрыты для модификации.

<img src="../_resources/3025472f99ca201397cef68b831022e7.png" alt="3025472f99ca201397cef68b831022e7.png" width="504" height="370" class="jop-noMdConv">

### Принцип подстановки Лисков

> Функции, которые используют базовый тип, должны иметь возможность использовать подтипы базового типа, не зная об этом. *Роберт С. Мартин*

Два типа являются взаимозаменяемыми, если они проявляют такое поведение, при котором вызывающий не может определить разницу.

### Принцип разделения интерфейса

> Клиенты не должны быть вынуждены зависеть от методов, которые они не используют. *Роберт С. Мартин*

На языке Go:

1.  Обьявляем интерфейсы по месту использования
2.  Принимаем интерфейсы, возвращаем структуры (но не увлекаемся)

### Принцип инверсии зависимостей

- Модули верхнего уровня не должны зависеть от модулей нижнего уровня. Оба уровня должны зависеть от абстракций.
- Абстракции не должны зависеть от их деталей. Детали должны зависеть от абстракций
- Граф импора хорошо разработанной Go программы должен быть широким и относительно плоским вместо того, чтобы быть высоким и узким.

## DRY

> Каждая часть знания должна иметь единственное, непротиворечивое и авторитетное представление в рамках системы. Джереми Миллер

Или: в коде не должно быть более одного способа решить задачу

## KISS

Keep it simple, stupid (KISS)

Мы страемся разработать сложную систему специального назначения, используя простые решения на основе сложных систем общего назначения.

- Ozon - сложная система специального назначения
- Микросервис простое решение
- Kafka, postgres - сложные системы общего назначения

## YAGNI

You aren't gonna need it

Реализуем ту функциональность, которая нужна сейчас.

Этому помогают TDD (Test Driven Development) и интерфейсы в Go.

# 2\. Архитектурные паттерны

Поскольку программные продукты становились сложнее, начался поиск общих принципов, которые позволяли бы сделать их проектирование, реализацию и поддержку проще

## MVC

- **Модель **(*Model*) предоставляет данные и реагирует на команжы конроллера, изменяя свое состояние.
- **Представление **(*View*) отвечает за отображение данных модели пользователю, реагируя на изменение модели.
- **Контроллер **(*Controller*) интерпретирует действия пользователя, оповещая модель о необходимости изменений.

<img src="../_resources/478ccf3df6f7e2bd6f7ec453e3517d5a.png" alt="478ccf3df6f7e2bd6f7ec453e3517d5a.png" width="199" height="211" class="jop-noMdConv">

## MVP

- **Модель** *(Model)* \- данные для отображения
- **Вид** *(View)* \- реализует *отображение* данных (из Модели), обращается к Presenter за обновлениями, перенаправляет события от пользователя в Presenter
- **Представитель** *(Presenter) -* реализует взаимодействие между Моделью и Видом и содержит в себе всю логику представления данных о предметной области. При необходимости данные из хранилища преобразует для отображения во View

<img src="../_resources/a3cf5191ee5e03d97fb0c5059d24e8d6.png" alt="a3cf5191ee5e03d97fb0c5059d24e8d6.png" width="173" height="176" class="jop-noMdConv">

## Чистая архитектура

[статья на хабре](https://habr.com/ru/articles/269589/)

<img src="../_resources/674de9956d036ca004609193cf6648e1.png" alt="674de9956d036ca004609193cf6648e1.png" width="538" height="386" class="jop-noMdConv">

# 3\. Обзор паттернов проектирования программ

## Builder

создание сложных обьектов из простых

<img src="../_resources/01cae291c3b47eda8af9b810f75ea766.png" alt="01cae291c3b47eda8af9b810f75ea766.png" width="227" height="458">

![417506aca2fac8cdf82e35b1137c4f60.png](417506aca2fac8cdf82e35b1137c4f60.png)

## Singleton

Может быть только один инстанс этой сущности

<img src="../_resources/1d827eb17fc0bbf641d695b4755d6436.png" alt="1d827eb17fc0bbf641d695b4755d6436.png" width="293" height="318">

<img src="../_resources/c9a8b45302484feaa25530890becea22.png" alt="c9a8b45302484feaa25530890becea22.png" width="303" height="192">

## Proxy

<img src="../_resources/544e5008162d492bd99474955ad4ee5b.png" alt="544e5008162d492bd99474955ad4ee5b.png" width="505" height="389">

## Семафор

Один код может одновременно выполняться не более N раз

![b7e652db3fd41e04b02025fd3b4551af.png](b7e652db3fd41e04b02025fd3b4551af.png)

## Генератор

как yield в python

<img src="../_resources/47ebec61e6838e58fdae41060570c163.png" alt="47ebec61e6838e58fdae41060570c163.png" width="292" height="206">

**![5f03c5660511211ef393d3c340a4e59d.png](5f03c5660511211ef393d3c340a4e59d.png)**

**![0889051b6df58c1d54e12ee2cdf72031.png](0889051b6df58c1d54e12ee2cdf72031.png)**

## TDD **(tast-driven-development)**

разработка через тестирование

<img src="../_resources/6a2cb0b94493514025db7faf0daa9882.png" alt="6a2cb0b94493514025db7faf0daa9882.png" width="450" height="336">

## BDD (behaviour-driven development)

<img src="../_resources/bfe5a35616e8650e29ebc16726f49df8.png" alt="bfe5a35616e8650e29ebc16726f49df8.png" width="489" height="277">